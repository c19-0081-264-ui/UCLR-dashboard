<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>School System</title>
    <link rel="stylesheet" href="{{url_for('static', filename='styles.css')}}">
    <link rel="stylesheet" href="https://unicons.iconscout.com/release/v4.0.0/css/line.css">
    <script src="{{url_for('static', filename='script.js')}}"></script>
</head>
<body>
    <nav>
        <div class="container nav_container">
            <div class="nav_logo">
                <a href="{{url_for('home')}}"><h4>UCLR</h4></a>
            </div>
        </div>
    </nav>

    {% if session.get('role') == 'admin' %}
        <main>
            <div class="student_table">
                <div class="container table_container">
                    <div class="view_student">
                        <div class="table_header">
                            <h1>Student Records</h1>
                            <a href="{{url_for('register')}}">Add Student</a>
                        </div>
                        <div class="table_wrapper">
                            <table>
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>School ID</th>
                                    <th>Email</th>
                                    <th>Address</th>
                                    <th>Phone</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                
                                {% for std in students %}
                                <tr>
                                    <td>{{ std[2] }} {{ std[3] }}</td>
                                    <td>{{ std[1] }}</td>
                                    <td>{{ std[4] }}</td>
                                    <td>{{ std[6] }}</td>
                                    <td>{{ std[5] }}</td>
                                    <td class="action_btns">
                                        <a href="{{ url_for('edit_student', id=std[0]) }}" class="btn_edit"><i class="uil uil-edit"></i> Edit</a>
                                        <a href="{{ url_for('delete_student', id=std[0]) }}" class="btn_delete" onclick="return confirm('Delete this user?');"><i class="uil uil-trash-alt"></i> Delete</a>
                                    </td>
                                </tr>
                                {% else %}
                                <tr>
                                    <td colspan="6" style="text-align: center;">No students found.</td>
                                </tr>
                                {% endfor %}
                            </tbody>
                            </table>
                        </div>
                        <div>
                            <a href="{{url_for('logout')}}" class="btn_logout">Logout</a>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    
    {% elif session.get('role') == 'student' %}
        <div class="student_info">
            <div class="container student_container">
                <h1>Hello, {{ student[2] }} {{ student[3] }}</h1>
                <p>You are logged in as a <strong>Student</strong>.</p>
                
                <div class="card" style="background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); margin-top: 20px;">
                    <h3 style="justify-content: center;">My Details</h3>
                    
                    <form action="{{ url_for('edit_student', id=student[0]) }}" method="POST">
                        <div class="form_layout">
                            <label>School ID</label>
                            <input type="text" value="{{ student[1] }}" readonly style="background-color: #f0f0f0;">
                        </div>
                        <div class="form_layout">
                            <label>Name</label>
                            <input type="text" value="{{ student[2] }} {{ student[3] }}" readonly style="background-color: #f0f0f0;">
                        </div>
                        <div class="form_layout">
                            <label>Email</label>
                            <input type="email" value="{{ student[4] }}" readonly style="background-color: #f0f0f0;">
                        </div>
                        <div class="form_layout">
                            <label for="Phone">Phone</label>
                            <input type="tel" id="Phone" name="phone" value="{{ student[5] }}">
                        </div>
                        <div class="form_layout">
                            <label for="Address">Address</label>
                            <input type="text" id="Address" name="address" value="{{ student[6] }}">
                        </div>

                        <div class="form_layout" id="password_container" style="display: none;">
                            <label for="Password">New Password</label>
                            <input type="password" id="Password" name="password" placeholder="Enter new password" value="{{ student[7] }}">
                        </div>
                        
                        <input type="hidden" name="password" value="{{ student[7] }}">
                        <button class="btn secondary" type="button" onclick="togglePassword()">Change Password</button>
                        <button class="btn primary" type="submit">Update Contact Info</button>
                        
                    </form>
                </div>
                <div>
                    <a href="{{url_for('logout')}}" class="btn_logout">Logout</a>
                </div>
            </div>
        </div>
    {% endif %}
</body>
</html>